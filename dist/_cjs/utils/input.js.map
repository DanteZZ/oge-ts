{"version":3,"file":"input.js","sourceRoot":"","sources":["../../../src/utils/input.ts"],"names":[],"mappings":"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","sourcesContent":["import eventEmitter from \"./eventEmitter\";\n\ninterface iKeys {\n  [key: number | string]: string | undefined;\n}\n\ninterface iInputBuffer {\n  keys: iKeys;\n  mouseKeys: iKeys;\n  mouseX: number;\n  mouseY: number;\n}\n\ntype tKey = number | string;\n\nexport class InputBuffer {\n  inputBuffer: iInputBuffer = {\n    keys: {},\n    mouseKeys: {},\n    mouseX: 0,\n    mouseY: 0,\n  };\n\n  constructor() {\n    this.initEventListeners();\n    this.initDocEventListeners();\n  }\n\n  private initEventListeners() {\n    eventEmitter.on(\"afterRender\", () => {\n      const res: iKeys = {};\n      for (const k in this.inputBuffer.keys) {\n        if (this.inputBuffer.keys[k] !== \"released\") {\n          res[k] = this.inputBuffer.keys[k];\n        }\n        if (this.inputBuffer.keys[k] == \"pressed\") {\n          res[k] = \"hold\";\n        }\n      }\n      this.inputBuffer.keys = res;\n\n      // MOUSE KEYS\n      const mouseRes: iKeys = {};\n      for (const k in this.inputBuffer.mouseKeys) {\n        if (this.inputBuffer.mouseKeys[k] !== \"released\") {\n          res[k] = this.inputBuffer.mouseKeys[k];\n        }\n        if (this.inputBuffer.mouseKeys[k] == \"pressed\") {\n          res[k] = \"hold\";\n        }\n      }\n      this.inputBuffer.mouseKeys = mouseRes;\n    });\n  }\n\n  private initDocEventListeners() {\n    document.addEventListener(\"keydown\", (handler) => {\n      const key = handler.keyCode;\n      if (this.inputBuffer.keys[key] == undefined) {\n        this.inputBuffer.keys[key] = \"pressed\";\n      } else {\n        this.inputBuffer.keys[key] = \"hold\";\n      }\n    });\n\n    document.addEventListener(\"keyup\", (handler) => {\n      const key = handler.keyCode;\n      this.inputBuffer.keys[key] = \"released\";\n    });\n\n    //Mouse\n    document.onmousedown = (e) => {\n      const key = e.button;\n      this.inputBuffer.mouseKeys[key] = \"pressed\";\n    };\n\n    document.onmouseup = (e) => {\n      const key = e.button;\n      this.inputBuffer.mouseKeys[key] = \"released\";\n    };\n    document.onmousemove = (e) => {\n      this.inputBuffer.mouseX = e.clientX;\n      this.inputBuffer.mouseY = e.clientY;\n    };\n  }\n\n  public onKeyPress(key: tKey): Boolean {\n    if (this.inputBuffer.keys[key] !== undefined) {\n      if (this.inputBuffer.keys[key] == \"pressed\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public onKeyHold(key: tKey): Boolean {\n    if (this.inputBuffer.keys[key] !== undefined) {\n      if (this.inputBuffer.keys[key] !== \"released\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public onKeyRelease(key: tKey): Boolean {\n    if (this.inputBuffer.keys[key] !== undefined) {\n      if (this.inputBuffer.keys[key] == \"released\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // MOUSE FUNCTIONS\n  public onMousePress(key: tKey): Boolean {\n    if (this.inputBuffer.mouseKeys[key] !== undefined) {\n      if (this.inputBuffer.mouseKeys[key] == \"pressed\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public onMouseHold(key: tKey): Boolean {\n    if (this.inputBuffer.mouseKeys[key] !== undefined) {\n      if (this.inputBuffer.mouseKeys[key] !== \"released\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public onMouseRelease(key: tKey): Boolean {\n    if (this.inputBuffer.mouseKeys[key] !== undefined) {\n      if (this.inputBuffer.mouseKeys[key] == \"released\") {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\nconst Input = new InputBuffer();\n\nexport default Input;\n"]}